self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[41],{2139:function(e,t,n){"use strict";var r=n(1),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=i},2523:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(4),i=n(2139),a=n(18);function s(e,t,n,i){return o(u(e),t,n,i,function(t,n){Object(a.o)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(r.g)(e),t.sessionAdd])})}function c(e,t,n,r){return o(e,t,n,r)}function o(e,t,n,r,a){for(var s=[],c=0;s.length<t&&i.a.recipientCache&&c<i.a.recipientCache.length;){var o=i.a.recipientCache[c];if(e(o)){var u=!1,d=o.EmailAddress;n&&l(d,n)&&(u=!0),r&&r.indexOf(d.MailboxType)>=0&&(u=!0),u||(s.push(o),a&&a(o,c))}c++}return s}var u=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}};function l(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}},2533:function(e,t,n){"use strict";function r(e){if(e){var t=(e=(e=e.replace(/['"]+/g,"")).trim()).split(/([<\[\({])+/g),n=void 0,r=e;return t.length>=3&&(n=t.slice(0,t.length-2).join("").trim(),r=t[t.length-1].split(/([>\]\)}])+/g)[0].trim()),{EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:r,Name:n||r}}}return{EmailAddress:{EmailAddress:e}}}n.d(t,"a",function(){return r})},3549:function(e,t,n){"use strict";var r=n(1583),i=n(7);t.a=Object(i.action)("updateFindResultTransactionId")(function(e,t){var n,i="";t&&(Object(r.a)()?(n=t).Groups&&n.Instrumentation&&(i=n.Instrumentation.TraceId):"Success"==(n=t).ResponseClass&&n.ResultSet&&(i=n.TransactionId));e.findResultTransactionId=i})},3550:function(e,t,n){"use strict";var r=n(4),i=n(7),a=n(3677),s=n.n(a),c=n(3678),o=n.n(c),u=n(29),l=n(12);function d(e){var t=o()({EntityFeedbackEntries:e});return s()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;l.c.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),l.c.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(d(e.entityFeedbackEntries),l.c.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},3555:function(e,t,n){"use strict";var r=n(0),i=n(5),a=n(1273),s=n.n(a),c=n(937),o=n.n(c),u=n(1458),l=n.n(u),d=n(418),f=n.n(d),p=n(995),b=n.n(p),h=n(57),O=n.n(h),m=n(1169),S=n.n(m),g=n(29),v=20,j=10,y="owa.react.compose",R="NewMail.To";function E(e){return f()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:e?v:j})}function A(e){return{__type:"FindPeopleContextInfo:#Exchange",RecipientsTo:e}}function I(e){if(Object(i.d)("rp-requestPersonaResponseShape")){var t=[O()({FieldURI:"PersonaEmailAddress"}),O()({FieldURI:"EmailAddresses"}),O()({FieldURI:"PersonaDisplayName"}),O()({FieldURI:"PersonaDisplayNames"}),O()({FieldURI:"PersonaId"}),O()({FieldURI:"PersonaType"})];return e&&t.push(O()({FieldURI:"FeatureData"})),b()({BaseShape:"IdOnly",AdditionalProperties:t})}return b()({BaseShape:"Default"})}function T(e){var t=e?R:y;return[s()({Key:"AppName",Value:"OWA"}),s()({Key:"AppScenario",Value:t})]}function P(e,t,n,r,i){var a=function(e,t,n,r,i){var a=["Mailbox"];return t&&a.push("Directory"),l()({IndexedPageItemView:E(t),PersonaShape:I(n),QuerySources:a,QueryString:e,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,IncludeImplicitGroups:r,Context:T(r),ContextInfo:A(i||[])})}(e,t,n,r,i);return S()(o()({Header:Object(g.getJsonRequestHeader)(),Body:a})).then(function(e){return e.Body})}var w=n(3775),_=n(1583);function D(){return Object(_.a)()?w.a:P}var C=n(7),F=n(3588),x=n(3680),k=n(3561),N=Object(C.action)("postProcessSuggestionsResult")(function(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return 1==e.findResultSet.length&&i&&Object(x.a)(e)?[4,Object(F.a)(e,[{isValid:!0,newPersona:e.findResultSet[0],newEmailAddress:null}])]:[3,2];case 1:return r.sent(),[3,3];case 2:e.findResultType=n,Object(k.a)(e,!0,!1,t),r.label=3;case 3:return[2]}})})}),M=n(3683);function q(e,t){Object(_.a)()?function(e,t){var n,i;try{for(var a=r.__values(t.Groups),s=a.next();!s.done;s=a.next()){var c=s.value;if("People"===c.Type){var o=c.Suggestions.filter(function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]});c.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]});t.ResultSet=n}(e,t)}var L=n(3875),W=Object(C.action)("processResponseResults")(function(e,t,n,r,i){if(n){var a=new Map;e.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),q(a,t)}Object(_.a)()?Object(M.a)(e,t,n,r,i):Object(L.a)(e,t,n,r)}),G=n(3563),U=n(3564),Q=n(3585),B=n(3549),J=n(6),V=n(2291),H=n(4),z=n(3550),K=n(3567),X=n(74),$=n(12),Y=Object(C.action)("transactionCompleted")(function(e,t,n,r,i,a,s,c){if(void 0===c&&(c=null),e&&e.hasSessionStarted){var o={TransactionRequestTime:Object(J.hb)(i),TransactionRequestDuration:Object(J.r)(Object(J.Db)(),i),QueryString:Object(H.g)(t)?"":t,QueryStringLength:Object(X.b)(t)?0:t.length,PersonaTypeList:s,ImpressionId:r};c&&Object.keys(c).forEach(function(e){o[e]=c[e]}),a&&(o.Context=a);var u=JSON.stringify(o),l=JSON.stringify(n),d=Object(K.a)(e,r,"TransactionCompleted",l,0,u);Object(z.a)(e,d,!1),$.c.info(Object(H.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),Z=n(3682);function ee(e,t){var n=[];e.findResultSet&&e.findResultSet.length>0&&e.findResultSet.forEach(function(e){n.push(Z.a[e.PersonaTypeString])});var r,i;Y(e.findPeopleFeedbackManager,e.queryString,(r=e.findResultSet,i=[],r&&r.forEach(function(e,t){i[t]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name}),i),e.findResultTransactionId,t,{Action:"Type Down"},n)}var te=Object(C.action)("autoSearchDirectory")(function(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var a,s,c;return r.__generator(this,function(r){switch(r.label){case 0:return a=D(),s=Object(J.Db)(),Object(G.b)(e,s,null,!0),[4,a(n,!0)];case 1:return c=r.sent(),Object(U.a)(e,!1),e.queryString.trim()==n?(20,Object(Q.a)(e,n),W(e.findResultSet,c,!1,20,!0),Object(G.b)(e,s,c,!0),Object(B.a)(e,c),ee(e,s),e.directorySearchType=V.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),[4,N(e,t,V.b.SearchDirectory,i)]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})}),ne=n(1),re=n(3684),ie=n(3818),ae=n(3844),se=(Object(ne.orchestrator)(re.a,function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter(function(e){return Object(ie.a)(e.persona,n)});if(i&&i.length>0){for(var a=r?i.length-1:0,s=[],c=0;c<=a;c++)i[c]&&!i[c].blockWellItemRemoval&&s.push(i[c]);s.length>0&&Object(ae.a)(t,s)}}),n(3845)),ce=(Object(ne.orchestrator)(se.a,function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach(function(e){var n={EmailAddress:e};t.filter(function(e){return!!e}).forEach(function(e){return Object(re.a)(e,n,!0)})})}),n(3598)),oe=Object(ne.action)("addRecipientsToRecipientWell",function(e,t){return{newRecipients:e,recipientWellRecipients:t}}),ue=oe;Object(ne.mutator)(oe,function(e){var t,n=e.recipientWellRecipients;(t=n.recipients).splice.apply(t,r.__spread([n.recipients.length,0],e.newRecipients)),n.isDirty=!0});var le=Object(ne.mutatorAction)("resetRecipientWell",function(e){e&&(e.queryString="",e.findResultType=V.b.None)}),de=n(3603),fe=n(3754),pe=n(2139),be=n(3846),he=Object(C.action)("addToCache")(function(e){e&&0!=e.length&&e.forEach(function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(be.a)(e);if(t&&!pe.a.allKeys[t]){var n=r.__assign({},e,{sessionAdd:!0});pe.a.recipientCache.push(n),pe.a.allKeys[t]=!0}}})}),Oe=n(3653),me=(Object(ne.orchestrator)(F.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i,a,s,c,o,u,l,d,f,p,b,h,O;return r.__generator(this,function(m){switch(m.label){case 0:t=e.recipientWell,n=e.recipientData,i=e.resetFindResult,a=[];try{for(s=r.__values(n),c=s.next();!c.done;c=s.next())o=c.value,d=Object(ce.a)(o.newPersona,o.isValid,o.newEmailAddress),a.push(d)}catch(e){p={error:e}}finally{try{c&&!c.done&&(b=s.return)&&b.call(s)}finally{if(p)throw p.error}}ue(a,t),m.label=1;case 1:m.trys.push([1,7,8,9]),u=r.__values(a),l=u.next(),m.label=2;case 2:return l.done?[3,6]:(d=l.value,i&&t?(le(t),Object(k.a)(t,!0,!0),t.inForceResolve?[4,Object(fe.a)(t,t.recipients)]:[3,4]):[3,4]);case 3:m.sent(),m.label=4;case 4:d.isValid&&he([d.persona]),t&&t.recipients&&1===t.recipients.length&&d.isValid&&Object(de.a)(t),m.label=5;case 5:return l=u.next(),[3,2];case 6:return[3,9];case 7:return f=m.sent(),h={error:f},[3,9];case 8:try{l&&!l.done&&(O=u.return)&&O.call(u)}finally{if(h)throw h.error}return[7];case 9:return Object(Oe.a)(t,n),[2]}})})}),Object(ne.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})()),Se=Object(C.action)("transactionFailed")(function(e,t,n,r,i,a){if(void 0===a&&(a=null),e&&e.hasSessionStarted){var s={TransactionRequestTime:Object(J.hb)(r),TransactionRequestDuration:Object(J.r)(Object(J.Db)(),r),QueryString:Object(H.g)(t)?"":t,QueryStringLength:Object(X.b)(t)?0:t.length,ImpressionId:n};a&&Object.keys(a).forEach(function(e){s[e]=a[e]}),i&&(s.Context=i);var c=JSON.stringify(s),o=Object(K.a)(e,n,"TransactionFailed",null,0,c);Object(z.a)(e,o,!1),$.c.info(Object(H.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}});function ge(e,t){Se(e.findPeopleFeedbackManager,e.queryString,e.findResultTransactionId,t,{Action:"Type Down"})}var ve=Object(C.action)("backfillCache")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i;return r.__generator(this,function(r){return me.pendingFindPeopleRequests++,n=D(),i=Object(J.Db)(),Object(G.b)(e,i,null),[2,n(t,!1,!1).then(function(n){try{var r=function(e){if(Object(_.a)()){var t=[];return Object(M.a)(t,e,!1),t}return e.ResultSet}(n);if(he(r),me.pendingFindPeopleRequests--,!function(e){if(Object(_.a)()){var t=e;return!t||!t.Groups}var t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}(n)&&e.queryString==t){var a=e.findResultSet.length>0;Object(G.b)(e,i,n),W(e.findResultSet,n,a,5),Object(B.a)(e,n),ee(e,i)}}catch(t){ge(e,i)}})]})})});var je=n(3692),ye=n(18),Re=Object(C.action)("setFindResultSet")(function(e,t){e.findResultSet=t});var Ee=n(3599),Ae=Object(C.action)("processCacheResult")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(c){switch(c.label){case 0:return i&&(s=new Map,e.findResultSet.forEach(function(e){s[e.EmailAddress.EmailAddress]=e}),t=function(e,t){return t.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]})}(s,t),(t=r.__spread(e.findResultSet,t)).splice(5)),Object(U.a)(e,!1),Re(e,t),Object(B.a)(e),Object(Ee.a)(e),[4,N(e,n,V.b.Cache,a)];case 1:return c.sent(),[2]}})})}),Ie=n(2523);function Te(e,t){var n=Object(Ie.a)(e,5,t);return 0==n.length?[]:n.map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString}})}var Pe=n(3580),we=Object(C.action)("findPeopleCacheFirst")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s,c,o;return r.__generator(this,function(r){switch(r.label){case 0:if(s=V.b.Cache,c=new ye.a(je.a.SearchCacheFirst.name),e.directorySearchType=V.a.None,Object(U.a)(e,!0),function(e,t,n,r,i){var a=Object(J.Db)(),s=Te(e,Object(Pe.a)(t));Object(G.a)(n,a,s),Ae(n,s,t,r,i)}(t,n,e,i,a),Object(Q.a)(e,t),!(e.findResultSet.length<5))return[3,6];r.label=1;case 1:return r.trys.push([1,5,,6]),e.findResultSet.length>0&&me.pendingFindPeopleRequests<3?(ve(e,t),s=V.b.MixedCacheLive,[3,4]):[3,2];case 2:return 0!=e.findResultSet.length?[3,4]:[4,ve(e,t)];case 3:r.sent(),s=V.b.FindPeople,r.label=4;case 4:return[3,6];case 5:return o=r.sent(),me.pendingFindPeopleRequests--,c.endWithError("ServerError",o),[3,6];case 6:return e.findResultSet.length>0?[4,N(e,n,s,a)]:[3,8];case 7:return r.sent(),[3,10];case 8:return[4,te(e,n,t,a)];case 9:r.sent(),s=V.b.SearchDirectory,r.label=10;case 10:return Object(U.a)(e,!1),c.addCustomData([s,t==e.queryString]),c.end(),[2]}})})}),_e=5;var De=n(3681),Ce=n(3691),Fe=function(e,t,n,i,a,s){return function(){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return s.isTimedOut=!0,[4,xe(e,n,t,i,a,s)];case 1:return r.sent(),[2]}})})}},xe=Object(C.action)("searchCacheFallback")(function(e,t,n,i,a,s){return r.__awaiter(this,void 0,void 0,function(){var c,o;return r.__generator(this,function(r){return e.queryString.trim()==t.trim()&&(c=Object(J.Db)(),o=Te(t,Object(Pe.a)(n)),Object(G.a)(e,c,o,!0),Object(Q.a)(e,t),e.directorySearchType=V.a.None,o.length>0?Ae(e,o,n,i,a):s&&(s.isCacheEmpty=!0)),[2]})})});t.a=Object(C.action)("findReadWriteRecipient")(Object(C.select)({store:function(){return me}})(function(e,t,n,a,s,c,o,u){return r.__awaiter(this,void 0,void 0,function(){var l,d,f,p,b,h,O,m,S,g,v,j,y,R,E,A,I,T,P;return r.__generator(this,function(r){switch(r.label){case 0:return n||Object(G.c)(e),l=Object(De.a)(e,s),d=!1,e.shouldShowFindResult||Object(k.a)(e,!0,!1,l),c&&c.length>0&&(f=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<_e&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,c))&&f.length>0&&(e.findResultSet=f,d=!0),!o&&!Object(i.d)("rp-peopleSuggestionsCacheFirst")||n?[3,2]:[4,we(e,t,l,d,a)];case 1:return r.sent(),[2];case 2:return p=!1,u.store.pendingFindPeopleRequests<3?(P=new ye.a(je.a.SearchPeopleIndex.name),Object(U.a)(e,!0),b=e.currentRenderedQueryString,h=e.directorySearchType,Object(i.d)("rp-optimizeAutoSearchDirectory")&&""!=b&&!n&&h==V.a.Auto&&b.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,te(e,l,t,a)]:[3,4]):[3,19];case 3:return r.sent(),p=!0,P.addCustomData([!1,!0,!0,!1,!0,Object(_.a)()]),P.end(),[3,18];case 4:return O={isTimedOut:!1,isCacheEmpty:!1},n||Object(Ce.a)()?(S=null,[3,7]):[3,5];case 5:return g=setTimeout,[4,Fe(e,l,t,d,a,O)];case 6:S=g.apply(void 0,[r.sent(),1e3]),r.label=7;case 7:m=S,v=Object(J.Db)(),r.label=8;case 8:return r.trys.push([8,16,,18]),u.store.pendingFindPeopleRequests++,j=D(),y=[],l.forEach(function(e){y.push(e.persona.EmailAddress.EmailAddress)}),Object(G.b)(e,v,null,n),[4,j(t,n,null,Object(i.d)("cmp-implicitgroups"),y)];case 9:return R=r.sent(),u.store.pendingFindPeopleRequests--,clearTimeout(m),E=e.queryString==t,Object(G.b)(e,v,R,n),O.isTimedOut&&!O.isCacheEmpty||!E?[3,15]:(Object(Q.a)(e,t),e.directorySearchType=n?V.a.Manual:V.a.None,A=n?20:5,W(e.findResultSet,R,d,A,n),ee(e,v),e.findResultSet.length>0?(Object(U.a)(e,!1),Object(B.a)(e,R),I=n?V.b.SearchDirectory:V.b.FindPeople,[4,N(e,l,I,a)]):[3,11]);case 10:return r.sent(),[3,14];case 11:return[4,xe(e,t,l,d,a)];case 12:return r.sent(),0!==e.findResultSet.length?[3,14]:(p=!0,[4,te(e,l,t,a)]);case 13:r.sent(),r.label=14;case 14:P.addCustomData([O.isTimedOut,E,n,O.isCacheEmpty,p,Object(_.a)()]),P.end(),r.label=15;case 15:return[3,18];case 16:return T=r.sent(),P.endWithError("ServerError",T),ge(e,v),[4,xe(e,t,l,d,a)];case 17:return r.sent(),[3,18];case 18:return[3,21];case 19:return P=new ye.a("FindPeopleThresholdHit"),[4,xe(e,t,l,d,a)];case 20:r.sent(),P.end(),r.label=21;case 21:return Object(U.a)(e,!1),[2]}})})}))},3561:function(e,t,n){"use strict";var r=n(3549),i=n(3681),a=n(3664),s=n(3665),c=n(3652),o=n(3599),u=n(3580),l=n(7);t.a=Object(l.action)("showHideFindResult")(function(e,t,n,l){var d=e.findResultSet?e.findResultSet.length:0;if(e.findResultHightlightIndex=-1,n&&d&&e.findResultSet.splice(0,d),t)if(Object(s.a)(e.findPeopleFeedbackManager),0!=e.queryString.length||e.inForceResolve)e.findResultHightlightIndex=0;else{var f=Object(i.a)(e,l);Object(c.a)(e.findResultSet,Object(u.a)(f)),Object(r.a)(e),Object(o.a)(e)}else Object(a.a)(e.findPeopleFeedbackManager);e.shouldShowFindResult=t})},3563:function(e,t,n){"use strict";var r=n(6),i=n(1583);n.d(t,"c",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var a="Cache",s="Mailbox",c="Directory",o=" Fallback";function u(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function l(e,t,n,a){if(i.a&&e.peopleFeedbackState){var o={TraceId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=Object(r.rb)(t),o.QueryString=e.queryString,o.SuggestionSource=a?c:s;var u=n;o.RawResponse=u?JSON.stringify(u):"pending",u&&u.Instrumentation&&(o.TraceId=u.Instrumentation.TraceId),a?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function d(e,t,n,s){if(Object(i.a)()&&e.peopleFeedbackState){var c={TraceId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};c.QueryString=e.queryString,c.TimeStamp=Object(r.rb)(t),c.SuggestionSource=s?a+o:a,c.RawResponse=JSON.stringify(n),e.peopleFeedbackState.cache=c}}},3564:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setIsSearching")(function(e,t){e.isSearching!=t&&(e.isSearching=t)})},3567:function(e,t,n){"use strict";var r=n(4),i=n(7),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),s=n(74),c=n(12),o=n(6);function u(e,t,n,i,u,l,d,f){if(void 0===f&&(f=Object(o.Db)()),!e)return c.c.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(s.b)(e.clientSessionId))return c.c.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var p={ClientEventTimeUtc:Object(o.jb)(f),ClientEventTimeLocal:Object(o.hb)(f),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:l,ScenarioName:d||e.entityScenarioName};return a(e),p}n.d(t,"a",function(){return u})},3580:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},3585:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("updateCurrentRenderedQueryString")(function(e,t){e.currentRenderedQueryString=t})},3588:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("addReadWriteRecipients",function(e,t,n){return void 0===n&&(n=!0),{recipientWell:e,recipientData:t,resetFindResult:n}});t.a=i},3598:function(e,t,n){"use strict";var r=n(2142),i=n(1300),a=n(56);t.a=function(e,t,n){e||(e={EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:n,Name:n}});var s=e.EmailAddress.Name?e.EmailAddress.Name:e.EmailAddress.EmailAddress;if(!Object(a.a)()){var c=e.EmailAddress.EmailAddress?e.EmailAddress.EmailAddress.split("@")[1]:"",o="ExternalMailbox"===e.EmailAddress.MailboxType||"LinkedIn"===e.EmailAddress.MailboxType;!s||Object(i.a)(s)&&s.split("@")[1]===c||!o||(s=s+" ("+c+")")}return{persona:e,displayText:s,isValid:t,isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:r.a.None,members:[]}}},3599:function(e,t,n){"use strict";var r=n(4),i=n(3550),a=n(3567),s=n(6),c=n(74),o=n(12),u=n(7),l=n(94),d=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,d,f){if(void 0===f&&(f=Object(s.Db)()),e&&e.hasSessionStarted){var p={TransactionRequestTime:Object(s.hb)(f),TransactionRequestDuration:Object(s.r)(Object(s.Db)(),f),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(c.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:d,ImpressionId:Object(l.a)()},b=JSON.stringify(p),h=JSON.stringify(n),O=Object(a.a)(e,"","LocalCacheTransactionCompleted",h,0,b);Object(i.a)(e,O,!1),o.c.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),f=n(3682);function p(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(f.a[e.PersonaTypeString])}),d(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return p})},3607:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setCommonWellItemSelectedState")(function(e,t){e.isSelected=t})},3617:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4),i=n(3567),a=n(12);function s(e,t){if(Object(r.g)(e.clientSessionId))return a.c.warn(Object(r.b)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;var n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));var s="";if(!Object(r.g)(t.endSessionAction)){var c={EndSessionAction:t.endSessionAction};s=JSON.stringify(c)}return Object(i.a)(e,"",t.eventType,n,0,s)}},3652:function(e,t,n){"use strict";var r=n(0),i=n(2523),a=n(7);t.a=Object(a.action)("getAndPopulateSuggestedContacts")(function(e,t){var n=Object(i.a)("",5,t).map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}});e.splice.apply(e,r.__spread([0,e.length],n))})},3653:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=i},3654:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("updateIsEditing")(function(e,t){e.isEditing=t})},3664:function(e,t,n){"use strict";var r=n(4),i=n(3550),a=n(3617),s=n(12),c=n(7);t.a=Object(c.action)("pauseSession")(function(e){if(e&&e.hasSessionStarted&&!e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!0,s.c.info(Object(r.b)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3665:function(e,t,n){"use strict";var r=n(4),i=n(3550),a=n(3617),s=n(12),c=n(7);t.a=Object(c.action)("resumeSession")(function(e){if(e&&e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!1,s.c.info(Object(r.b)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3666:function(e,t,n){"use strict";var r=n(7);t.a=Object(r.action)("setForceResolveState")(function(e,t){e.inForceResolve=t})},3680:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}n.d(t,"a",function(){return r})},3681:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3680);function i(e,t){return Object(r.a)(e)?e.recipients:t||[]}},3682:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},3683:function(e,t,n){"use strict";var r=n(0),i=n(7),a=n(3816);t.a=Object(i.action)("processSubstrateSuggestionsResponse")(function(e,t,n,i,s){var c,o;if(!t||!t.Groups)throw new Error("Response groups should not be null");var u=[];i=i||20,i=n?i-e.length:i;try{for(var l=r.__values(t.Groups),d=l.next();!d.done;d=l.next()){var f=d.value;if("People"===f.Type){f.Suggestions.forEach(function(e){if(u.length<i){var t=Object(a.a)(e,s);t&&u.push(t)}});break}}}catch(e){c={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(c)throw c.error}}n?e.push.apply(e,r.__spread(u)):e.splice.apply(e,r.__spread([0,e.length],u))})},3684:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("removePersonaFromWell",function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}});t.a=i},3691:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2139);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},3692:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},3754:function(e,t,n){"use strict";var r=n(0),i=n(3894),a=n(3666),s=n(3561),c=n(3654),o=n(7),u=n(18);t.a=Object(o.action)("resolveAllUnresolvedRecipients")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,l,d;return r.__generator(this,function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(n&&n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(o=-1,l=0;l<t.length;l++)if(t[l].persona&&t[l].persona.EmailAddress&&!t[l].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(d=t[l].persona).EmailAddress.MailboxType&&Object(u.o)("EmptyEmailAddress",[d.EmailAddress.MailboxType,d.EmailAddress.RoutingType]),!t[l].isValid){o=l;break}-1!=o?Object(c.a)(t[o],!0):(Object(a.a)(e,!1),Object(s.a)(e,!1)),r.label=3;case 3:return[2]}})})})},3765:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},3775:function(e,t,n){"use strict";var r=n(0),i=n(3558);function a(){return"Bound"==Object(i.e)().status}var s=n(5),c=n(94),o=n(75),u=n(56),l=n(3765),d=n(282),f=n(12),p=n(242);n.d(t,"a",function(){return j});var b="/search/api/v1/init?",h="https://outlook.office365.com/search",O="https://substrate.office.com/SubstrateSearch-Internal.ReadWrite",m="/search/api/v1/suggestions?",S="owa.react.compose",g="20",v="5";function j(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var i,s,u,l;return r.__generator(this,function(r){switch(r.label){case 0:return""!=e?[3,1]:[2,y()];case 1:return[4,R(e,t,n,a)];case 2:return i=r.sent(),s=function(e){return{AppName:"OWA",Scenario:{Name:S},Cvid:Object(c.a)(),EntityRequests:[e]}}(i),u=o.d,l=[m+A(),s,void 0,!1],[4,I()];case 3:return[2,u.apply(void 0,l.concat([r.sent(),void 0,void 0,!1])).then(function(e){return e}).catch(function(e){return f.c.error(e),null})]}})})}function y(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return Object(u.a)()&&Object(s.d)("rp-linkedInPeopleSuggestions")&&a()?((e={}).headers=new Headers,[4,Object(d.getDelegationTokenForOwa)(O)]):[3,3];case 1:return t=r.sent(),e.headers.set("X-User-Context","litoken=bearer"),e.headers.set("Authorization","Bearer "+t),(n=Object(p.getDefaultAnchorMailboxCookie)())&&e.headers.append("X-AnchorMailbox",n),e.method="GET",[4,fetch(window.location.origin+b+A(),e)];case 2:return(i=r.sent())&&200==i.status?[2,i]:(f.c.error("makeInitRequest: Unsuccessful response status"),[2,null]);case 3:return c=o.b,l=[b+A(),void 0,!0],[4,I()];case 4:return[2,c.apply(void 0,l.concat([r.sent(),void 0,!1])).then(function(e){return e.json()}).catch(function(e){return f.c.error(e),null})]}})})}function R(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var c,o;return r.__generator(this,function(r){return c=Object(s.d)("rp-linkedInPeopleSuggestions")&&a(),o={Query:{QueryString:e},EntityType:"People",Provenances:E(t,c),Size:t?g:v},i&&i.length>0&&(o.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(i)),o.Fields=l.a,n&&o.Fields.push("FeatureData"),[2,o]})})}function E(e,t){var n=["Mailbox"];return e&&n.push("Directory"),t&&n.push("LinkedIn"),n}function A(){var e={scenario:S};return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function I(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return Object(s.d)("rp-linkedInPeopleSuggestions")&&a()?Object(u.a)()?[2,{"X-User-Context":"litoken=bearer"}]:[4,Object(d.getAccessTokenforResource)(h)]:[3,2];case 1:return[2,{"X-User-Context":"litoken="+e.sent()}];case 2:return[2,null]}})})}},3790:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,selectToRight:n,onRecipientDeletedCallback:r}});t.a=i,Object(r.orchestrator)(i,function(e){e.recipientWellRecipients.isDirty=!0;var t=e.recipientWellRecipients.recipients.splice(e.recipientIndex,1);e.onRecipientDeletedCallback(t,e.recipientIndex,e.recipientWellRecipients,e.selectToRight)})},3816:function(e,t,n){"use strict";var r=n(4),i=n(1592);function a(e,t){var n=e.EmailAddresses,a=e.DisplayName,u=e.Text,l=e.PDLItemId,d=e.ADObjectId,f=e.PersonaId,p=e.FeatureData,b=e.Id,h=e.ImAddress,O=e.JobTitle,m=e.PeopleSubtype,S=n?n[0]:null;if(!t&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(S))return null;var g={EmailAddress:S,Name:Object(r.g)(a)?u:a,MailboxType:o(m),RoutingType:s(m),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:a,ADObjectId:d,FeatureData:p,Id:b,ImAddress:h,EmailAddress:g,EmailAddresses:[g],PersonaTypeString:c(m),PersonaId:{Id:f},Title:O}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function c(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},3818:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",function(){return r})},3844:function(e,t,n){"use strict";var r=n(0),i=n(3603),a=n(3653),s=n(3790),c=n(3607),o=n(7);function u(e,t,n,r){e[0].isSelected&&n.recipients.length>0&&Object(c.a)(n.recipients[r?Math.min(t,n.recipients.length-1):Math.max(0,t-1)],!0)}t.a=Object(o.action)("removeReadWriteRecipients")(function(e,t,n,c){var o,l;void 0===c&&(c=!0);var d=!1;try{for(var f=r.__values(t),p=f.next();!p.done;p=f.next()){var b=p.value,h=-1;if((h="number"==typeof b?b:e.recipients.indexOf(b))>=0){if(e.recipients[h].blockWellItemRemoval)return;Object(s.a)(h,e,n,u),d=!0}1===e.recipients.length&&Object(i.a)(e)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(l=f.return)&&l.call(f)}finally{if(o)throw o.error}}c&&d&&Object(a.a)(e)})},3845:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("removeRecipientsFromRecipientWells",function(e,t){return{emailAddresses:e,recipientWells:t}});t.a=i},3846:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},3875:function(e,t,n){"use strict";var r=n(0),i=n(7);t.a=Object(i.action)("processFindPeopleResult")(function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=[],o=0;o<i;o++){var u=t.ResultSet[o];u.EmailAddress?c.push({EmailAddress:a(u.EmailAddress),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName}):"ImplicitGroup"==u.PersonaTypeString&&c.push({EmailAddress:s(u),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,Members:u.Members,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName})}n?e.push.apply(e,r.__spread(c)):e.splice.apply(e,r.__spread([0,e.length],c))});var a=function(e){return e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?r.__assign({},e,{EmailAddress:e.OriginalDisplayName}):e},s=function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}}},3894:function(e,t,n){"use strict";var r=n(0),i=n(3588),a=n(3555),s=n(7),c=Object(s.action)("setDirectorySearchType")(function(e,t){e.directorySearchType=t}),o=n(3564),u=n(3561),l=n(2533),d=n(2291),f=n(1300);t.a=Object(s.action)("resolveQueryStringToRecipient")(function(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var p,b;return r.__generator(this,function(r){switch(r.label){case 0:return c(e,n?d.a.Manual:d.a.None),(p=e.queryString.trim())?t?(Object(o.a)(e,!1),b=Object(l.a)(p),[4,Object(i.a)(e,[{isValid:Object(f.a)(b.EmailAddress.EmailAddress),newPersona:b}])]):[3,2]:[3,7];case 1:return r.sent(),[3,6];case 2:return e.queryString.indexOf("@")>=0&&e.inForceResolve?(Object(o.a)(e,!1),[4,Object(i.a)(e,[{isValid:Object(f.a)(p),newPersona:null,newEmailAddress:p}])]):[3,4];case 3:return r.sent(),[3,6];case 4:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,s)];case 5:r.sent(),r.label=6;case 6:return[3,8];case 7:Object(o.a)(e,!1),Object(u.a)(e,!0,!0),r.label=8;case 8:return[2]}})})})}}]);
//# sourceMappingURL=owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js.map
self.scriptsLoaded['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();