self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SearchDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[357],{1318:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(1),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),o=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1332:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},1372:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return c});var r=n(3),a=new r.c(function(){return Promise.all([n.e(3),n.e(5),n.e(62),n.e(196)]).then(n.bind(null,2352))}),i=Object(r.d)(a,function(e){return e.FeedbackForm}),o=Object(r.d)(a,function(e){return e.FeedbackRibbon}),c=Object(r.d)(a,function(e){return e.NewConsumerRecruitmentForm})},1396:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},3700:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),a=new r.c(function(){return n.e(110).then(n.bind(null,4137))}),i=new r.b(a,function(e){return e.sendAutomatedMessage})},438:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},446:function(e){e.exports={c:"yEa",f:"zEa",e:"AEa",b:"BEa",g:"CEa",a:"DEa",d:"EEa"}},4965:function(e,t,n){var r=n(5821),a=n(44);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5046:function(e,t,n){"use strict";n.r(t);var r=100;var a=n(3686),i=n(1),o=Object(i.mutatorAction)("addSearchRequestInstrumentationMutator",function(e){!function(e,t){for(var n,a=e.SearchQueryId,i=-1,o=t.length-1;o>=0;o--)if(t[o].SearchQueryId==a){i=o;break}n=-1==i?0:i+1,t.splice(n,0,e),t.length>r&&t.splice(r)}(e,a.a.searchInstrumentationList)}),c=n(3943);function u(e){o(e),Object(c.b)()}var s=n(18),l="cpv",d="SearchProvider",f="BeHttpStatus",m="ClientHttpStatus",h="ClientRequestID",g="PageNumber",b="RequestId",S="MSEdgeRef",p="DiagnosticsCheckpoints",C="ClientNetworkTime",v="ClientJsPreRequestTime",j="ClientJSRequestThreadTime",w="ClientJsResponseProcessTime",_="ClientJsRenderingTime";var y=Object(i.mutatorAction)("addResourceTimingEntryMutator",function(e,t,n){if(e.ResourceTimingEntry=t,n){var r=n.waterfallTimings.promise;e.ClientJSEndToEndTime=r-e.ClientJSRenderingTime}});function T(e,t,n){y(t,e,n),function(e){var t,n=new s.a("SearchInstrumentation"),r={};if(e.ResourceTimingEntry){var a=e.ResourceTimingEntry;Object.keys(a).forEach(function(e){return r[e]=a[e]}),r[l]=[(t=a).RdS,t.RdE,t.FS,t.DS,t.DE,t.CS,t.SCS,t.CE,t.RqS,t.RpS,t.RpE].join("/")+"/"}r[d]=e.ClientSearchProvider,r[f]=e.SearchBEHttpStatus,r[m]=e.ClientHttpStatus,r[h]=e.SearchClientRequestID,r[g]=e.PageNumber,r[b]=e.SearchTraceID,r[S]=e.SearchMsEdgeRef,r[p]=e.DiagnosticsCheckpoints,r[C]=e.ClientNetworkTime,r[v]=e.ClientJSPreRequestTime,r[j]=e.ClientJSRequestThreadTime,r[w]=e.ClientResponseProcessTime,r[_]=e.ClientJSRenderingTime,n.addCustomData(r),n.end(e.ClientJSEndToEndTime)}(t)}n.d(t,"addSearchRequestInstrumentation",function(){return u}),n.d(t,"addResourceTimingEntry",function(){return T})},5048:function(e,t,n){"use strict";var r=n(2),a=n(51),i=n(5),o=n(1372),c=n(48),u=n(0),s=n(27),l=n(3700),d=n(4001),f=n(620),m=function(e,t,n){return u.__awaiter(void 0,void 0,void 0,function(){var r,a,i;return u.__generator(this,function(o){switch(o.label){case 0:return[4,l.a.import()];case 1:return r=o.sent(),a={subject:"OWA 3S Query Feedback",message:h(t,n),to:e==U.CalendarSearch?["owasearchdog@microsoft.com"]:["owa3squeryfeedback@service.microsoft.com"],attachments:null},i=Object(s.f)().UserOptions.TimeFormat,r(a,i),[2]}})})},h=function(e,t){var n=t?t.filter(function(e){return""!=e}).map(b).join("\n"):f.i.customFields.map(S).join("\n"),r=d.d.searchInstrumentationList.slice();r.forEach(function(e){delete e.PIIData,e.ResourceTimingEntry&&Object.keys(e.ResourceTimingEntry).forEach(function(t){"cpv"!=t&&(e[t]=e.ResourceTimingEntry[t])}),delete e.ResourceTimingEntry});var a=p(r),i=g(r),o=i?"<h2>Error Information</h2>"+i+"\n\n\n":"";return("<h2>Categories</h2>"+n+" \n\n\n\n        <h2>Verbatim</h2>"+(e||f.i.message)+"\n\n\n\n        "+o+"\n        <h2>Search History</h2>"+a.replace(/\n/g,"")).replace(/\n/g,"<br />")},g=function(e){if(!e||0===e.length)return null;var t=e[0].SearchErrorContent;if(!t)return null;try{var n=JSON.parse(JSON.parse(t).MessageText);return"\n            <strong>HTTP code:</strong> "+n.httpCode+"\n\n            <strong>Code:</strong> "+n.code+"\n\n            <strong>Description:</strong> "+n.description+"\n\n        "}catch(e){return null}},b=function(e){return String.fromCharCode(9745)+"&nbsp;"+e},S=function(e){return(e.Value?String.fromCharCode(9745):String.fromCharCode(9744))+"&nbsp;"+e.Name},p=function(e){return null==e||0==e.length?"":'<table border="1">\n            '+C(e)+"\n            "+v(e)+"\n        </table>"},C=function(e){return"<thead><tr>\n        "+Object.keys(e[0]).map(function(e){return"<th>"+function(e){return"SearchQueryId"==e?"SearchConversationId":e}(e)+"</th>"}).join("")+"\n    </tr></thead>"},v=function(e){return e.map(function(e){return"<tr>\n                    "+Object.keys(e).map(function(t){return j(e[t])}).join("")+"\n                </tr>"}).join("")},j=function(e){return null==e?"<td></td>":e instanceof Array?"<td>"+e.join(",")+"</td>":e instanceof Date?"<td>"+e.toISOString()+"</td>":"<td>"+e.toString()+"</td>"},w=n(54),_=n(4965),y=n(203),T="What issues did you encounter?",E="Tell us what happened or how we can improve",x="Did you find what you were looking for?",k="Thanks for your feedback!",O="Submit more feedback?",R=Object(a.a)(function(e){var t={title:T,categories:[{logString:"No results were found",uiString:"No results were found"},{logString:"Search was slow",uiString:"Search was slow"},{logString:"The results weren't relevant",uiString:"The results weren't relevant"},{logString:"The item I was looking for wasn't in the results",uiString:"The item I was looking for wasn't in the results"},{logString:"Search suggestions weren't useful",uiString:"Search suggestions weren't useful"},{logString:"Search is hard to use",uiString:"Search is hard to use"},{logString:"Other",uiString:"Other"}],ghostText:E,createUVTicket:!0,submitCallBack:function(t,n){m(e.userVoiceTeam,t,n)}};return r.createElement("div",{className:y(e.cssClass,_.inlineRibbonContainer)},r.createElement(o.b,{ribbonMessage:x,thankYouMessage:k,moreFeedbackRibbonMessage:O,feature:"Search",metadata:e.currentSearchQueryId,yesCallBack:function(){Object(c.o)(e.userVoiceTeam==U.MailSearch?w.a.Mail:w.a.Calendar,!0,e.currentSearchQueryId,x)},noCallBack:function(){Object(c.o)(e.userVoiceTeam==U.MailSearch?w.a.Mail:w.a.Calendar,!1,e.currentSearchQueryId,x)},noFeedbackDialogParams:t,yesFeedbackDialogParams:t}))}),I=n(4),z=n(20),N=n(5822);function H(e){var t,n=d.d.searchInstrumentationList.map(function(e){return u.__assign({},e)});n.forEach(function(e){delete e.PIIData});var r=null,a=null;switch(e){case U.MailSearch:a="OWA 3S Query Feedback",r="Owa mail React";break;case U.CalendarSearch:a="OWA Calendar 3S Query Feedback",r="Owa calendar React"}return(t={Type:"General Negative"})["Team 1"]=a,t.FeedbackLocationName=r,t.SearchHistory=Object(N.escape)(JSON.stringify(n)),t}var U,V=n(271),G=n(81),M=n(209),W=n(816),A=n(2521),D=n(4965),F=n(203),Q="What issues did you encounter?",q="Tell us what happened or how we can improve",L="Submit search feedback",P="View diagnostics",B="({0} sec)",J="New Ticket for Search In-Context Feedback",K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getLastSearchRequestTimeInSeconds=function(){var e,n,r=d.d.searchInstrumentationList.slice().reverse();try{for(var a=u.__values(r),i=a.next();!i.done;i=a.next()){var o=i.value;if(0==o.PageNumber&&o.SearchQueryId==t.props.currentSearchQueryId)return o.ClientJSEndToEndTime/1e3}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return 0},t}return u.__extends(t,e),t.prototype.render=function(){var e=this,t=this.getLastSearchRequestTimeInSeconds(),n=Object(I.b)(B,t);return r.createElement("div",{className:F(this.props.cssClass,D.linkContainer)},r.createElement(A.a,{onClick:function(){return e.showSearchInContextFeedbackDialog(e.props.userVoiceTeam)},styles:function(){return{root:{alignItems:"center",display:"flex",fontSize:"12px",marginRight:"16px"}}}},r.createElement(M.a,{iconName:"Info",className:D.linkIcon}),L),Object(i.d)("fwk-devTools")&&r.createElement(A.a,{styles:function(){return{root:{alignItems:"center",display:"flex",fontSize:"12px"}}},onClick:function(){Object(G.c)(6),W.g.import().then(function(e){return e(d.a)})}},r.createElement(M.a,{iconName:"DeveloperTools",className:D.linkIcon}),P," ",t?n:""))},t.prototype.showSearchInContextFeedbackDialog=function(e){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(t){switch(t.label){case 0:return[4,f.h.import()];case 1:return[4,t.sent()({title:J,feedbackType:7,header:Q,blurbElement:r.createElement("div",null),textAreaPlaceHolder:q,customTags:H(e)})];case 2:return t.sent()===V.a.ok&&m(e),[2]}})})},t=u.__decorate([z.observer],t)}(r.Component);n.d(t,"a",function(){return U}),function(e){e[e.MailSearch=0]="MailSearch",e[e.CalendarSearch=1]="CalendarSearch"}(U||(U={}));var Y=Object(a.a)(function(e){return r.createElement(r.Fragment,null,Object(i.d)("sea-inlineFeedback")&&r.createElement(R,{cssClass:e.cssClass,currentSearchQueryId:e.currentSearchQueryId,userVoiceTeam:e.userVoiceTeam}),!Object(i.d)("sea-inlineFeedback")&&r.createElement(K,{cssClass:e.cssClass,currentSearchQueryId:e.currentSearchQueryId,userVoiceTeam:e.userVoiceTeam}))});t.b=Y},5821:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,'._3dSe40gHUbVBeZaEHdQ9_g,.Gt5UwAtljmgzbtWGof77V,._3bxQ1PC6ugs0doouyfcEg1{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}html[dir] ._3dSe40gHUbVBeZaEHdQ9_g,html[dir] .Gt5UwAtljmgzbtWGof77V,html[dir] ._3bxQ1PC6ugs0doouyfcEg1{border-bottom:1px solid var(--neutralLight);margin-top:-1px}html[dir=ltr] ._3dSe40gHUbVBeZaEHdQ9_g,html[dir=ltr] .Gt5UwAtljmgzbtWGof77V,html[dir=ltr] ._3bxQ1PC6ugs0doouyfcEg1{margin-left:-12px;margin-right:-24px}html[dir=rtl] ._3dSe40gHUbVBeZaEHdQ9_g,html[dir=rtl] .Gt5UwAtljmgzbtWGof77V,html[dir=rtl] ._3bxQ1PC6ugs0doouyfcEg1{margin-right:-12px;margin-left:-24px}html[dir] .Gt5UwAtljmgzbtWGof77V{padding-bottom:8px}html[dir=ltr] .Gt5UwAtljmgzbtWGof77V{padding-left:12px}html[dir=rtl] .Gt5UwAtljmgzbtWGof77V{padding-right:12px}html[dir=ltr] ._3dSe40gHUbVBeZaEHdQ9_g{padding-left:18px}html[dir=rtl] ._3dSe40gHUbVBeZaEHdQ9_g{padding-right:18px}._1w0F9GLCfYYq13WQMIRjWE{font-size:11px}._2WNie-9Tn5jUVe2C_E1pqU{max-width:600px;max-height:600px;width:400px}._1OMcBG9gLkgszKkLmWBk62,._2WNie-9Tn5jUVe2C_E1pqU{font-size:14px;font-weight:400}._1OMcBG9gLkgszKkLmWBk62{max-height:80%;overflow:auto}._2a0u5otqPpXbqLKZM8Gzc9{line-height:30px}html[dir] ._2YYsGYNSrrM6ADvsAcZS_z{margin:5px 0}._3jzx2ilLHWran9D13SzFja{resize:none;height:100px;font-size:14px;font-weight:400;font-size:12px}._3jzx2ilLHWran9D13SzFja::-webkit-input-placeholder{color:"[theme:neutralTertiary, default:#a6a6a6]";font-size:12px}._3jzx2ilLHWran9D13SzFja::-moz-placeholder{color:"[theme:neutralTertiary, default:#a6a6a6]";font-size:12px}._3jzx2ilLHWran9D13SzFja:-ms-input-placeholder{color:"[theme:neutralTertiary, default:#a6a6a6]";font-size:12px}._3jzx2ilLHWran9D13SzFja:-moz-placeholder{color:"[theme:neutralTertiary, default:#a6a6a6]";font-size:12px}html[dir] ._2as8UwK1_1ScH8sSmP59Az{border:1px solid "[theme:neutralTertiary, default:#a6a6a6]";margin:20px 0 0 0}._3jzUDryWLcQUunv7TO6Mm5{visibility:hidden}html[dir] ._2NaGMRg1vqqHKj-GJy8-WB{margin-top:2px}html[dir=ltr] ._2NaGMRg1vqqHKj-GJy8-WB{margin-right:6px}html[dir=rtl] ._2NaGMRg1vqqHKj-GJy8-WB{margin-left:6px}',""]),t.locals={inlineRibbonContainer:"_3dSe40gHUbVBeZaEHdQ9_g",linkContainer:"Gt5UwAtljmgzbtWGof77V",linkContainerBase:"_3bxQ1PC6ugs0doouyfcEg1",feedbackLauncher:"_1w0F9GLCfYYq13WQMIRjWE",dialogContainer:"_2WNie-9Tn5jUVe2C_E1pqU",content:"_1OMcBG9gLkgszKkLmWBk62",titleText:"_2a0u5otqPpXbqLKZM8Gzc9",feedbackCategoryCheckbox:"_2YYsGYNSrrM6ADvsAcZS_z",textArea:"_3jzx2ilLHWran9D13SzFja",textAreaContainer:"_2as8UwK1_1ScH8sSmP59Az",invisible:"_3jzUDryWLcQUunv7TO6Mm5",linkIcon:"_2NaGMRg1vqqHKj-GJy8-WB"}},5822:function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(102))},620:function(e,t,n){"use strict";n.d(t,"f",function(){return u}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return d});var r=n(883);n.d(t,"a",function(){return r.m}),n.d(t,"c",function(){return r.n}),n.d(t,"e",function(){return r.o});var a=n(3),i=n(1318);n.d(t,"i",function(){return i.b});var o=n(1332);n.d(t,"d",function(){return o.a});var c=new a.c(function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(62),n.e(407)]).then(n.bind(null,2348))}),u=new a.a(c,function(e){return e.launchInAppFeedback}),s=new a.b(c,function(e){return e.postSuggestionAndSendLogDatapoint}),l=new a.b(c,function(e){return e.showUserVoiceSuggestionDialog}),d=Object(a.d)(c,function(e){return e.UserVoiceNps})},7917:function(e,t,n){"use strict";n.r(t);var r=n(5048);n.d(t,"SearchInContextFeedback",function(){return r.b})},81:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var o=n(438);Object(r.mutator)(o.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var c=n(1396),u=(Object(r.orchestrator)(c.a,function(){Object(o.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),s=(Object(r.orchestrator)(u,function(){a(4)}),n(620));Object(r.orchestrator)(s.d,function(){a(2)});function l(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return o.a})},883:function(e,t,n){"use strict";n.d(t,"g",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"i",function(){return h}),n.d(t,"k",function(){return g}),n.d(t,"f",function(){return b}),n.d(t,"m",function(){return S}),n.d(t,"n",function(){return p}),n.d(t,"o",function(){return C}),n.d(t,"p",function(){return v}),n.d(t,"q",function(){return j}),n.d(t,"l",function(){return w}),n.d(t,"e",function(){return _}),n.d(t,"d",function(){return y});var r=n(0),a=n(446),i=n(4),o=n(612),c=n.n(o),u="N/A",s="",l="CheckErrorDetails",d="React/Nps",f="UVNpsRating",m="UVFeedback",h="React/Feedback",g="Search_{0}",b="NoUserMessage",S="https://outlook.uservoice.com/forums/{0}",p=601444,C=907141,v=4,j=15;function w(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function _(e){return e?"1":"2"}function y(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,c()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):s]}})})}}},0,[0,1,30,474,155,2,6,172,4,7,11,513,354,3,5,62,196,463,87,464,98,110]]);
//# sourceMappingURL=owa.SearchDiagnostics.js.map
self.scriptsLoaded['owa.SearchDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SearchDiagnostics.js'] = (new Date()).getTime();